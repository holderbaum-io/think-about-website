<div>
<h1 id="schedule"><%= t('schedule.title') %></h1>
<% i = 0 %>
<% data('schedule').each do |day, events| %>
<div>
  <h2><%= t('schedule.day')[i] %><% i += 1 %></h2>
  <div class="header"><span>Hall 1</span><span>Hall 2</span></div>
  <% events.group_by { |e| e[:start_time] }.each do |_, parallel_events| %>
      <% sorted_events = parallel_events.sort_by { |e| e[:stage] } %>
      <% if sorted_events[0][:track] == 'Orga' %>
      <div class="orga">
        <span><%= sorted_events[0][:start_time] %> - <%= sorted_events[0][:end_time] %></span>
        <span><%= sorted_events[0][:title] %></span>
      </div>
      <% else %>
      <div class="slot">
        <span><%= sorted_events[0][:start_time] %> - <%= sorted_events[0][:end_time] %></span>
        <% sorted_events.each do |talk| %>
        <section topic="<%= talk[:track].downcase %>">
          <% if talk[:track].downcase == 'keynote' %><h4><%= talk[:track] %></h4><% end %>
          <%= "<a href=\"/speakies/#{talk[:person_slug]}.html\">" if talk[:has_person] %>
          <article>
            <header>
              <span><%= talk[:start_time] %> - <%= talk[:end_time] %></span>
              <span><%= talk[:stage] %></span>
              <span><%= talk[:track] %></span>
            </header>
            <p>"<%= talk[:title]%>" <em><%= talk[:lang] %></em></p>
            <% if talk[:has_person] %>
            <hr/>
            <footer>
              <div><h1><%= talk[:person] %></h1><p><%= talk[:company] %></p></div>
              <% talk[:images].each do |path| %>
                <figure><img src="<%= path %>" /></figure>
              <% end %>
            </footer>
            <% end %>
          </article>
          <%= "</a>" if talk[:has_person] %>
        </section>
        <% end %>
      </div>
      <% end %>
  <% end %>
</div>
<% end %>
</div>
